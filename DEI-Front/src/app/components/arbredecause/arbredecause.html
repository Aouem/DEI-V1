<div class="container mt-4">

  <!-- Message de chargement -->
  <div *ngIf="isLoading" class="d-flex align-items-center mb-3">
    <div class="spinner-border text-success me-2" role="status">
      <span class="visually-hidden">Loading...</span>
    </div>
    <span>Chargement des arbres des causes...</span>
  </div>

  <!-- Message d'erreur -->
  <div *ngIf="errorMessage" class="alert alert-danger">
    {{ errorMessage }}
  </div>

  <!-- Message de succ√®s -->
  <div *ngIf="successMessage" class="alert alert-success">
    {{ successMessage }}
  </div>

  <!-- Titre -->
  <h3 class="text-center text-success mb-4">üå≥ Arbres des Causes</h3>

  <!-- Filtres -->
  <div class="card mb-4">
    <div class="card-header bg-success text-white">
      <i class="fas fa-filter me-2"></i>Filtres
    </div>
    <div class="card-body">
      <div class="row">
     <div class="col-md-6">
  <label for="incidentFilter" class="form-label">Filtrer par Incident ID:</label>
  <input 
    type="number" 
    id="incidentFilter" 
    class="form-control" 
    placeholder="Entrez l'ID de l'incident..."
    [(ngModel)]="incidentFilter"
    (input)="applyFilters()"
    min="1"
  >
  <small class="text-muted">Entrez uniquement des nombres</small>
</div>
        <div class="col-md-6 d-flex align-items-end">
          <button class="btn btn-outline-secondary" (click)="clearFilters()">
            <i class="fas fa-times me-1"></i>Effacer les filtres
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- R√©sultats filtr√©s -->
  <div *ngIf="filteredArbres.length === 0 && arbres.length > 0" class="alert alert-warning">
    Aucun r√©sultat trouv√© avec les filtres actuels.
  </div>

  <!-- Tableau des arbres -->
  <div *ngIf="filteredArbres.length > 0" class="table-responsive">
    <table class="table table-striped table-hover align-middle">
      <thead class="table-success">
        <tr>
          <th>ID</th>
          <th>Date</th>
          <th>Incident ID</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let arbre of filteredArbres">
          <td>{{ arbre.id }}</td>
          <td>{{ arbre.dateSurvenue | date:'dd/MM/yyyy HH:mm' }}</td>
          <td>{{ arbre.incidentId }}</td>
          <td>
            <!-- Bouton Voir -->
            <button class="btn btn-success btn-sm me-2" (click)="viewArbre(arbre)">
              <i class="fas fa-eye me-1"></i>Voir
            </button>

            <!-- Bouton Supprimer -->
            <button class="btn btn-danger btn-sm" (click)="confirmDelete(arbre)">
              <i class="fas fa-trash me-1"></i>Supprimer
            </button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Aucun donn√©es -->
  <div *ngIf="arbres.length === 0 && !isLoading" class="alert alert-info">
    Aucun arbre des causes disponible.
  </div>

  <!-- Image s√©lectionn√©e -->
  <div *ngIf="selectedImageUrl" class="mt-4 text-center p-3 border border-success rounded bg-light">
    <h5 class="text-success mb-3">Arbre des causes s√©lectionn√© :</h5>
    <img [src]="selectedImageUrl" alt="Arbre des causes" class="img-fluid rounded shadow-sm">
    <div class="mt-2">
      <button class="btn btn-secondary btn-sm" (click)="selectedImageUrl = null">
        <i class="fas fa-times me-1"></i>Fermer
      </button>
    </div>
  </div>

</div>